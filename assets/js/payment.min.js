function payWithStripe(r){r.preventDefault(),$form.find("[type=submit]").html('Validating <i class="fa fa-spinner fa-pulse"></i>');var e="pk_test_6pRNASCoBOKtIshFeQd4XMUh";Stripe.setPublishableKey(e);var a=$form.find("[name=cardExpiry]").payment("cardExpiryVal"),t={number:$form.find("[name=cardNumber]").val().replace(/\s/g,""),cvc:$form.find("[name=cardCVC]").val(),exp_month:a.month,exp_year:a.year};Stripe.card.createToken(t,function(r,e){if(e.error)$form.find("[type=submit]").html("Try again"),$form.find(".payment-errors").text(e.error.message),$form.find(".payment-errors").closest(".row").show();else{$form.find("[type=submit]").html('Processing <i class="fa fa-spinner fa-pulse"></i>'),$form.find(".payment-errors").closest(".row").hide(),$form.find(".payment-errors").text(""),console.log(e.id),console.log(e.card);var a=e.id;$.post("/account/stripe_card_token",{token:a}).done(function(){$form.find("[type=submit]").html('Payment successful <i class="fa fa-check"></i>').prop("disabled",!0)}).fail(function(){$form.find("[type=submit]").html("There was a problem").removeClass("success").addClass("error"),$form.find(".payment-errors").text("Try refreshing the page and trying again."),$form.find(".payment-errors").closest(".row").show()})}})}var $form=$("#payment-form");$form.on("submit",payWithStripe),$("input[name=cardNumber]").payment("formatCardNumber"),$("input[name=cardCVC]").payment("formatCardCVC"),$("input[name=cardExpiry").payment("formatCardExpiry"),jQuery.validator.addMethod("cardNumber",function(r,e){return this.optional(e)||Stripe.card.validateCardNumber(r)},"Please specify a valid credit card number."),jQuery.validator.addMethod("cardExpiry",function(r,e){return r=$.payment.cardExpiryVal(r),this.optional(e)||Stripe.card.validateExpiry(r.month,r.year)},"Invalid expiration date."),jQuery.validator.addMethod("cardCVC",function(r,e){return this.optional(e)||Stripe.card.validateCVC(r)},"Invalid CVC."),validator=$form.validate({rules:{cardNumber:{required:!0,cardNumber:!0},cardExpiry:{required:!0,cardExpiry:!0},cardCVC:{required:!0,cardCVC:!0}},highlight:function(r){$(r).closest(".form-control").removeClass("success").addClass("error")},unhighlight:function(r){$(r).closest(".form-control").removeClass("error").addClass("success")},errorPlacement:function(r,e){$(e).closest(".form-group").append(r)}}),paymentFormReady=function(){return $form.find("[name=cardNumber]").hasClass("success")&&$form.find("[name=cardExpiry]").hasClass("success")&&$form.find("[name=cardCVC]").val().length>1?!0:!1},$form.find("[type=submit]").prop("disabled",!0);var readyInterval=setInterval(function(){paymentFormReady()&&($form.find("[type=submit]").prop("disabled",!1),clearInterval(readyInterval))},250);